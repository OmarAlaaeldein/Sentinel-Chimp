Here is the text-based guide on how to manually upgrade your `sentinel.py` file to include the new features.

**1. Upgrade the Math Class (VegaChimpCore)**
You need to completely replace the contents of your `VegaChimpCore` class. Currently, it only has a `bs_price` method for Black-Scholes. You need to add two new static methods to this class:

* **Add a GARCH(1,1) Method:** This should take a list of returns and return an annualized volatility number. It uses a recursive formula (sigma squared equals omega plus alpha times residuals squared plus beta times previous sigma squared) to forecast future volatility rather than just looking at the past.
* **Add a Bjerksund-Stensland Method:** This is the critical upgrade for pricing. It is a mathematical approximation specifically for American Options (which most stocks are). It checks if "early exercise" is profitable (checking if the cost of carry is less than the risk-free rate). If it is, it adjusts the price upward compared to standard Black-Scholes.

**2. Update the Technical Analysis Function**
In your `calculate_technicals` function, you need to add two specific calculations to the dataframe before returning it:

* **TTM Squeeze:** Calculate Keltner Channels (20 SMA +/- 1.5 ATR). Then, create a `Squeeze_On` column that is True if the Bollinger Bands are completely *inside* the Keltner Channels. This detects periods of extreme compression.
* **GARCH Volatility:** Calculate the log returns of the Close price. Pass these returns into your new GARCH method from step 1, and save the result as a new column called `GARCH_Vol`. This gives you a forward-looking volatility number for every day.

**3. Update the Options Scanner Logic**
Inside your `MarketApp` class, specifically in the `fetch_options_batch` method (where you loop through the options chain), you need to change how `fair` value is calculated:

* **Switch the Input Volatility:** Instead of always passing `self.hv_30`, check if `self.garch_vol` is available. Use the GARCH volatility if possible, as it is a better predictor of future movement.
* **Switch the Pricing Model:** Change the function call from `VegaChimpCore.bs_price` to `VegaChimpCore.bjerksund_stensland`. Pass the same arguments (Price, Strike, Time, Rate, Dividend=0, Volatility, Type).
* **Update the Verdict Logic:** Calculate the "Edge" as `Fair Value - Market Price`. If the Edge is greater than 15% of the Fair Value, mark it as "Underpriced" (Green). If it is less than -15%, mark it as "Overpriced" (Red).

**4. Update the Chart Logic**
Inside `update_chart`, you need to add a "Probability Cone":

* Check if you are viewing a daily chart (not intraday).
* Take the last known price and the current GARCH volatility.
* Project 30 days into the future. Calculate the upper and lower bounds for each future day using the formula: `Price * exp(Vol * sqrt(Time))`.
* Plot these two lines on the chart (usually in gray or orange dashed lines) to show the "Expected Move."